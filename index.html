<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Mboard</title>
  </head>
  <body class="relative">
    <div>
      <div class="px-4 py-3 bg-gray-50 flex justify-between sm:px-6">
        <h2 class="text-4xl font-extrabold tracking-tight">Mboard</h2>
        <div
          id="nav-bar-info"
          class="flex"
          style="cursor: pointer"
          onclick="profileClick()"
        >
          <div
            class="inline-flex items-center justify-center mr-2"
            id="nav-bar-profile"
          >
            <img
              class="h-7 w-7 rounded-full ring-2 ring-white mr-1"
              src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAM1BMVEXk5ueutLfn6eqrsbTp6+zg4uOwtrnJzc/j5earsbW0uby4vcDQ09XGyszU19jd3+G/xMamCvwDAAAFLklEQVR4nO2d2bLbIAxAbYE3sDH//7WFbPfexG4MiCAcnWmnrzkjIRaD2jQMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMw5wQkHJczewxZh2lhNK/CBOQo1n0JIT74/H/qMV0Z7GU3aCcVPuEE1XDCtVLAhgtpme7H0s1N1U7QjO0L8F7llzGeh1hEG/8Lo7TUmmuSrOfns9xnGXpXxsONPpA/B6OqqstjC6Ax/0ujkNdYQQbKNi2k64qiiEZ+ohi35X+2YcZw/WujmslYewiAliVYrxgJYrdwUmwXsU+RdApUi83oNIE27YvrfB/ZPg8+BJETXnqh9CVzBbTQHgojgiCvtqU9thFJg/CKz3VIMKMEkIXxIWqIpIg2SkjYj+xC816mrJae2aiWGykxRNsW0UwiJghJDljYI5CD8GRiCtIsJxizYUPQ2pzItZy5pcisTRdk/a9m4amtNNfBuQkdVhSaYqfpNTSFGfb9GRIakrE2Pm+GFLaCQPqiu0OpWP+HMPQQcgQMiQprWXNmsVwIjQjYi/ZrhAqNTCgr2gu0Jnz85RSSjso0HkMFZ0YZjKkc26a/jlmh9JiDyDxi9oeorTYAzZkwwoMz19pzj9bnH/GP/+qbchjSGflneWYhtTuKdMOmNKZcJ5TjInQKcYXnESd/jQxy0ENpULTNGOGgxpap/oyw9pbUAqhfx2Dbkhovvfgz4iUzoM9+GlK6/Mh4q29hyC1mwro30hpVVLPF9wYQr71RazOeM5/cw81iBRD+A03aM9/C/obbrKjbYSpCmIVG3qT/Q8oeUo3Rz0IL7vI1tEbCB9pSiu8I/aV8x3Kg/BGWrWp4ZVs0nZfmAoEG4h/61yHYIJiFSl6Q0Vk6tTW1N8kYp8hdOkfHYYMXd2Qft+8CYwqYDSKvqIh+MCF8Wgca2u/cwdgeW3TtuVn6+1oBs3yLo5C2JpK6CvQzGpfUkz9UG/87gCsi5o2LIXolxN0FbwAsjOLEr+YJmXn7iR6N0BCt5p5cMxm7eAsfS+/CACQf4CTpKjzgkvr2cVarVTf96372yut7XLJ1sa7lv6VcfgYrWaxqr3Wlo1S6pvStr22sxOtTNPLzdY3nj20bPP+ejFdJYkLsjGLdtPBEbe/mr2bQKiXWJDroA+vtzc0p9aahuwqHMDYrQEXHEw9jwQl3drMpts9JBU1SdktPe5FBRdJQ6bwXBpa57ib2A8kukQDzMjh++Uo7Fo6Wd02Pkf4fknqoo4HtvAIjsqUcjx6DIPgWCaOML9rKI/oqD9/lgNrn+eF+p7j8tnzHBiR7+kdUGw/+V1Kzkc75mMy6U+FMaxjPibiM1U1uGM+puInHpmALZCgP4pt7i840MV8+0R1zPsRB6UTcqpizncYwZ89syDydfyWCwXB1l8/zRNGWbTG/GHKUm9AkxHMc/EGSk3z2+ArEhPEV5TUBLEvUGFcjEUH80J/jveTGOAJEljJbILWGQT3zRYiwuKsUXN1EEJAzBhRJFll7mBUG7KD8EqPkKekBREaL8hMDZLQSG6AQjtHPYmvTQnX0TtpC1SYCe2YdkkyLP3jj5BSbKiuR585eQhTgoje6yIb0Yb0C+mV6EYvebqw5SDy2WmubogZiF2AVxPC2FpDf8H2Q9QWo6IkjUxTWVEI3WY/wrCeSuqJ+eRWzXR/JXwgVjUMozbCOfoEZiSiKVGepqv5CJ8RyR4D7xBeamqa7z3BJ/z17JxuBPdv93d/a2Ki878MMAzDMAzDMAzDMAzDMF/KP09VUmxBAiI3AAAAAElFTkSuQmCC"
              alt=""
              id="profile-img"
            />
            <span class="mr-2 text-gray-500" id="profile-role"></span>
            <span id="profile-nick" class="font-extrabold"></span>
          </div>
          <a
            href="./upload.html"
            class="mr-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            id="write"
          >
            글쓰기
          </a>
          <a
            href="./login.html"
            id="log-in"
            class="mr-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
          >
            로그인
          </a>
          <a
            href="./signup.html"
            class="mr-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            id="sign-up"
          >
            회원가입
          </a>
          <a
            href="./signup.html"
            class="hidden"
            id="log-out"
            onclick="logOut()"
          >
            로그아웃
          </a>
        </div>
      </div>
    </div>
    <div class="flex flex-col">
      <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
        <div class="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
          <div
            class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"
          >
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Name
                  </th>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Title
                  </th>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Date
                  </th>
                  <th
                    scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Role
                  </th>
                  <th scope="col" class="relative px-6 py-3">
                    <span class="sr-only">Edit</span>
                  </th>
                </tr>
              </thead>
              <tbody
                class="bg-white divide-y divide-gray-200"
                id="rows"
              ></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div
      class="bg-gray-50 px-4 py-3 flex items-center justify-center border-t border-gray-200 sm:px-6"
    >
      <div class="sm:flex-1 sm:flex sm:items-center sm:justify-between">
        <div>
          <p class="text-sm text-gray-700">
            현재 페이지
            <span class="font-medium" id="page-num">1</span>
            page of
            <span class="font-medium" id="total-num">10</span>
            results
          </p>
        </div>
        <a
          style="cursor: pointer"
          class="inline-flex items-center py-2 px-2 text-sm font-medium text-gray-500 bg-white rounded-lg border border-indigo-300 hover:bg-indigo-100 hover:text-gray-700 dark:bg-indigo-800 dark:border-indigo-700 dark:text-gray-400 dark:hover:bg-indigo-700 dark:hover:text-white ml-2"
          onclick="morePage()"
          id="all-btn"
        >
          모든 글 보기
        </a>
        <div>
          <nav
            class="relative z-0 inline-flex justify-between rounded-md shadow-sm -space-x-px"
            aria-label="Pagination"
          >
            <a
              style="cursor: pointer"
              class="inline-flex items-center py-2 px-4 mr-3 text-sm font-medium text-gray-500 bg-white rounded-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
              onclick="previousPage()"
              id="previous-btn"
            >
              <svg
                class="mr-2 w-5 h-5"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M7.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l2.293 2.293a1 1 0 010 1.414z"
                  clip-rule="evenodd"
                ></path>
              </svg>
              Previous
            </a>
            <a
              style="cursor: pointer"
              class="inline-flex items-center py-2 px-4 text-sm font-medium text-gray-500 bg-white rounded-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
              onclick="nextPage()"
              id="next-btn"
            >
              Next
              <svg
                class="ml-2 w-5 h-5"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </a>
          </nav>
        </div>
      </div>
    </div>

    <div
      class="hidden container flex justify-center mx-auto h-screen"
      id="main-modal"
    >
      <div
        class="absolute inset-0 flex items-center justify-center bg-gray-700 bg-opacity-50 h-screen"
        id="main-modal-absoulte"
      >
        <div
          class="bg-white mt-20 mb-36 items-center rounded-md max-w-7xl lg:pt-4 pt-4 mx-auto px-4 sm:px-6 lg:px-8 lg:flex-col lg:items-center lg:justify-between"
        >
          <h2
            class="text-2xl font-extrabold tracking-tight text-gray-900 sm:text-2xl"
          >
            <span class="block border-b pb-2" id="main-title"></span>
            <span
              class="mt-2 block text-indigo-600 text-lg"
              id="main-content"
            ></span>
            <img
              id="main-img"
              class="mx-auto my-2 rounded"
              style="max-height: 200px"
            />
          </h2>
          <div
            class="flex-col w-full mt-4 justify-center items-center"
            style="min-width: 500px"
          >
            <div class="bg-white w-full">
              <div class="flex-col w-full mb-2" id="main-comments">
                <span class="text-indigo-600 font-semibold text-lg"
                  >Comments</span
                >
                <div
                  class="flex justify-center border-t border-b py-1"
                  id="no-comments"
                >
                  <div class="-space-x-2">댓글 없음</div>
                </div>
              </div>
              <div class="flex items-center ml-3" id="with-login1">
                <div class="mr-3">
                  <img
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAM1BMVEXk5ueutLfn6eqrsbTp6+zg4uOwtrnJzc/j5earsbW0uby4vcDQ09XGyszU19jd3+G/xMamCvwDAAAFLklEQVR4nO2d2bLbIAxAbYE3sDH//7WFbPfexG4MiCAcnWmnrzkjIRaD2jQMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMw5wQkHJczewxZh2lhNK/CBOQo1n0JIT74/H/qMV0Z7GU3aCcVPuEE1XDCtVLAhgtpme7H0s1N1U7QjO0L8F7llzGeh1hEG/8Lo7TUmmuSrOfns9xnGXpXxsONPpA/B6OqqstjC6Ax/0ujkNdYQQbKNi2k64qiiEZ+ohi35X+2YcZw/WujmslYewiAliVYrxgJYrdwUmwXsU+RdApUi83oNIE27YvrfB/ZPg8+BJETXnqh9CVzBbTQHgojgiCvtqU9thFJg/CKz3VIMKMEkIXxIWqIpIg2SkjYj+xC816mrJae2aiWGykxRNsW0UwiJghJDljYI5CD8GRiCtIsJxizYUPQ2pzItZy5pcisTRdk/a9m4amtNNfBuQkdVhSaYqfpNTSFGfb9GRIakrE2Pm+GFLaCQPqiu0OpWP+HMPQQcgQMiQprWXNmsVwIjQjYi/ZrhAqNTCgr2gu0Jnz85RSSjso0HkMFZ0YZjKkc26a/jlmh9JiDyDxi9oeorTYAzZkwwoMz19pzj9bnH/GP/+qbchjSGflneWYhtTuKdMOmNKZcJ5TjInQKcYXnESd/jQxy0ENpULTNGOGgxpap/oyw9pbUAqhfx2Dbkhovvfgz4iUzoM9+GlK6/Mh4q29hyC1mwro30hpVVLPF9wYQr71RazOeM5/cw81iBRD+A03aM9/C/obbrKjbYSpCmIVG3qT/Q8oeUo3Rz0IL7vI1tEbCB9pSiu8I/aV8x3Kg/BGWrWp4ZVs0nZfmAoEG4h/61yHYIJiFSl6Q0Vk6tTW1N8kYp8hdOkfHYYMXd2Qft+8CYwqYDSKvqIh+MCF8Wgca2u/cwdgeW3TtuVn6+1oBs3yLo5C2JpK6CvQzGpfUkz9UG/87gCsi5o2LIXolxN0FbwAsjOLEr+YJmXn7iR6N0BCt5p5cMxm7eAsfS+/CACQf4CTpKjzgkvr2cVarVTf96372yut7XLJ1sa7lv6VcfgYrWaxqr3Wlo1S6pvStr22sxOtTNPLzdY3nj20bPP+ejFdJYkLsjGLdtPBEbe/mr2bQKiXWJDroA+vtzc0p9aahuwqHMDYrQEXHEw9jwQl3drMpts9JBU1SdktPe5FBRdJQ6bwXBpa57ib2A8kukQDzMjh++Uo7Fo6Wd02Pkf4fknqoo4HtvAIjsqUcjx6DIPgWCaOML9rKI/oqD9/lgNrn+eF+p7j8tnzHBiR7+kdUGw/+V1Kzkc75mMy6U+FMaxjPibiM1U1uGM+puInHpmALZCgP4pt7i840MV8+0R1zPsRB6UTcqpizncYwZ89syDydfyWCwXB1l8/zRNGWbTG/GHKUm9AkxHMc/EGSk3z2+ArEhPEV5TUBLEvUGFcjEUH80J/jveTGOAJEljJbILWGQT3zRYiwuKsUXN1EEJAzBhRJFll7mBUG7KD8EqPkKekBREaL8hMDZLQSG6AQjtHPYmvTQnX0TtpC1SYCe2YdkkyLP3jj5BSbKiuR585eQhTgoje6yIb0Yb0C+mV6EYvebqw5SDy2WmubogZiF2AVxPC2FpDf8H2Q9QWo6IkjUxTWVEI3WY/wrCeSuqJ+eRWzXR/JXwgVjUMozbCOfoEZiSiKVGepqv5CJ8RyR4D7xBeamqa7z3BJ/z17JxuBPdv93d/a2Ki878MMAzDMAzDMAzDMAzDMF/KP09VUmxBAiI3AAAAAElFTkSuQmCC"
                    alt=""
                    class="inline-block h-20 w-20 rounded-full ring-2 ring-white"
                    id="comments-img"
                  />
                </div>
                <div>
                  <h1 class="font-semibold" id="comments-nick">
                    사용자 정보없음
                  </h1>
                </div>
              </div>

              <div class="mt-3 w-full" id="with-login2">
                <textarea
                  rows="2"
                  class="border p-2 rounded w-full"
                  id="comment-content"
                  placeholder="Write something..."
                ></textarea>
              </div>

              <div class="flex my-2 justify-end" id="with-login3">
                <div>
                  <button
                    class="px-4 py-1 bg-gray-800 text-white rounded-md font-light hover:bg-gray-700"
                    id="comment-submit"
                    onclick="submitClick(this.ariaLabel)"
                  >
                    Submit
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div
            class="flex lg:mt-0 lg:flex-shrink-0 items-center justify-center"
          >
            <div class="ml-3 mb-2 inline-flex rounded-md shadow">
              <a
                id="main-close"
                onclick="mainXClick(this.id)"
                class="inline-flex items-center justify-center px-5 py-1 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-indigo-50"
                style="cursor: pointer"
              >
                닫기
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      id="toast-default"
      class="fixed bottom-10 right-10 flex items-center p-4 w-full max-w-xs text-gray-500 bg-white rounded-lg shadow dark:text-gray-400 dark:bg-gray-800"
      role="alert"
    >
      <div
        class="inline-flex flex-shrink-0 justify-center items-center w-8 h-8 text-blue-500 bg-blue-100 rounded-lg dark:bg-blue-800 dark:text-blue-200"
      >
        <svg
          class="w-5 h-5"
          fill="currentColor"
          viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z"
            clip-rule="evenodd"
          ></path>
        </svg>
      </div>
      <div class="ml-3 text-sm font-normal" id="toast-contents">
        가입하여 글을 작성해보세요!.
      </div>
      <button
        type="button"
        class="ml-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex h-8 w-8 dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700"
        data-collapse-toggle="toast-default"
        aria-label="Close"
        onclick="toastOff()"
      >
        <span class="sr-only">Close</span>
        <svg
          class="w-5 h-5"
          fill="currentColor"
          viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
            clip-rule="evenodd"
          ></path>
        </svg>
      </button>
    </div>

    <!-- edit modal begin -->
    <div class="hidden container flex justify-center mx-auto" id="edit-modal">
      <div
        class="fixed inset-0 flex items-center justify-center bg-gray-700 bg-opacity-50 h-screen"
      >
        <div class="w-96 p-6 bg-white rounded-md">
          <div class="flex items-center justify-between">
            <h3 class="text-2xl">편집하기</h3>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              style="cursor: pointer"
              onclick="xClick()"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
              />
            </svg>
          </div>
          <input
            type="text"
            class="mt-2 form-control border-solid border-2 border-indigo-600 w-80 rounded-md shadow-md"
            id="title"
            placeholder="title"
          />
          <textarea
            rows="5"
            class="form-control w-80 border-solid border-2 border-indigo-600 mt-2 rounded-md shadow-md"
            id="content"
            placeholder="write in contents"
          ></textarea>
          <input class="form-control w-80 mt-2" type="file" id="image" />
          <div class="px-4 py-3 bg-gray-50 text-center sm:px-6">
            <button
              type="submit"
              class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
              id="edit-btn"
              onclick="rewrite(this.id)"
            >
              edit
            </button>
            <button
              type="submit"
              class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-700 hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
              id="delete-btn"
              onclick="deleteClick(this.id)"
            >
              delete
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- edit modal end -->

    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-storage.js"></script>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyDZOwgMxWu87by_E-2NWqWtcrNpQxAhT8o",
        authDomain: "mboard-49849.firebaseapp.com",
        projectId: "mboard-49849",
        storageBucket: "mboard-49849.appspot.com",
        messagingSenderId: "14676285341",
        appId: "1:14676285341:web:e4bb749720befaa6a20174",
        measurementId: "G-8WCMSZ3SRV",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
    </script>
    <script>
      const db = firebase.firestore();
      const noPhoto =
        "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAM1BMVEXk5ueutLfn6eqrsbTp6+zg4uOwtrnJzc/j5earsbW0uby4vcDQ09XGyszU19jd3+G/xMamCvwDAAAFLklEQVR4nO2d2bLbIAxAbYE3sDH//7WFbPfexG4MiCAcnWmnrzkjIRaD2jQMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMw5wQkHJczewxZh2lhNK/CBOQo1n0JIT74/H/qMV0Z7GU3aCcVPuEE1XDCtVLAhgtpme7H0s1N1U7QjO0L8F7llzGeh1hEG/8Lo7TUmmuSrOfns9xnGXpXxsONPpA/B6OqqstjC6Ax/0ujkNdYQQbKNi2k64qiiEZ+ohi35X+2YcZw/WujmslYewiAliVYrxgJYrdwUmwXsU+RdApUi83oNIE27YvrfB/ZPg8+BJETXnqh9CVzBbTQHgojgiCvtqU9thFJg/CKz3VIMKMEkIXxIWqIpIg2SkjYj+xC816mrJae2aiWGykxRNsW0UwiJghJDljYI5CD8GRiCtIsJxizYUPQ2pzItZy5pcisTRdk/a9m4amtNNfBuQkdVhSaYqfpNTSFGfb9GRIakrE2Pm+GFLaCQPqiu0OpWP+HMPQQcgQMiQprWXNmsVwIjQjYi/ZrhAqNTCgr2gu0Jnz85RSSjso0HkMFZ0YZjKkc26a/jlmh9JiDyDxi9oeorTYAzZkwwoMz19pzj9bnH/GP/+qbchjSGflneWYhtTuKdMOmNKZcJ5TjInQKcYXnESd/jQxy0ENpULTNGOGgxpap/oyw9pbUAqhfx2Dbkhovvfgz4iUzoM9+GlK6/Mh4q29hyC1mwro30hpVVLPF9wYQr71RazOeM5/cw81iBRD+A03aM9/C/obbrKjbYSpCmIVG3qT/Q8oeUo3Rz0IL7vI1tEbCB9pSiu8I/aV8x3Kg/BGWrWp4ZVs0nZfmAoEG4h/61yHYIJiFSl6Q0Vk6tTW1N8kYp8hdOkfHYYMXd2Qft+8CYwqYDSKvqIh+MCF8Wgca2u/cwdgeW3TtuVn6+1oBs3yLo5C2JpK6CvQzGpfUkz9UG/87gCsi5o2LIXolxN0FbwAsjOLEr+YJmXn7iR6N0BCt5p5cMxm7eAsfS+/CACQf4CTpKjzgkvr2cVarVTf96372yut7XLJ1sa7lv6VcfgYrWaxqr3Wlo1S6pvStr22sxOtTNPLzdY3nj20bPP+ejFdJYkLsjGLdtPBEbe/mr2bQKiXWJDroA+vtzc0p9aahuwqHMDYrQEXHEw9jwQl3drMpts9JBU1SdktPe5FBRdJQ6bwXBpa57ib2A8kukQDzMjh++Uo7Fo6Wd02Pkf4fknqoo4HtvAIjsqUcjx6DIPgWCaOML9rKI/oqD9/lgNrn+eF+p7j8tnzHBiR7+kdUGw/+V1Kzkc75mMy6U+FMaxjPibiM1U1uGM+puInHpmALZCgP4pt7i840MV8+0R1zPsRB6UTcqpizncYwZ89syDydfyWCwXB1l8/zRNGWbTG/GHKUm9AkxHMc/EGSk3z2+ArEhPEV5TUBLEvUGFcjEUH80J/jveTGOAJEljJbILWGQT3zRYiwuKsUXN1EEJAzBhRJFll7mBUG7KD8EqPkKekBREaL8hMDZLQSG6AQjtHPYmvTQnX0TtpC1SYCe2YdkkyLP3jj5BSbKiuR585eQhTgoje6yIb0Yb0C+mV6EYvebqw5SDy2WmubogZiF2AVxPC2FpDf8H2Q9QWo6IkjUxTWVEI3WY/wrCeSuqJ+eRWzXR/JXwgVjUMozbCOfoEZiSiKVGepqv5CJ8RyR4D7xBeamqa7z3BJ/z17JxuBPdv93d/a2Ki878MMAzDMAzDMAzDMAzDMF/KP09VUmxBAiI3AAAAAElFTkSuQmCC";
      const rows = document.getElementById("rows");
      let first = db.collection("Board").orderBy("date", "desc").limit(10);
      let pages = 0;
      let currentPage = 1;
      let lastVisible = "";
      let firstVisible = "";
      let totalLength = "";

      // get total
      db.collection("Board")
        .orderBy("date", "desc")
        .get()
        .then((total) => {
          totalLength = total.docs.length;
          if (totalLength < 10) {
            document.getElementById("total-num").innerText = totalLength;
          } else {
            pages = parseInt(totalLength / 10) + 1;
            // 글의 개수가 적을 때 버튼 사용 못하게
            if (pages <= 1) {
              document.getElementById("next-btn").style.cursor = "not-allowed";
              document.getElementById("next-btn").setAttribute("onclick", "");
              document.getElementById("previous-btn").style.cursor =
                "not-allowed";
              document
                .getElementById("previous-btn")
                .setAttribute("onclick", "");
              document.getElementById("all-btn").style.cursor = "not-allowed";
              document.getElementById("all-btn").setAttribute("onclick", "");
            }
            document.getElementById("total-num").innerText = totalLength;
          }
          // show the lists
          first.get().then((items) => {
            // first and last items
            lastVisible = items.docs[items.docs.length - 1];
            firstVisible = items.docs[items.docs.length - 1];
            items.forEach((doc) => {
              writingRows(doc);
            });
          });
        });
      // 리스트 만들어주기
      function writingRows(doc) {
        let template = document.createElement("tr");
        firebase.auth().onAuthStateChanged((user) => {
          if (user) {
            db.collection("Users")
              .doc(`${user.email}`)
              .get()
              .then((info) => {
                if (
                  doc.data().userId == user.email ||
                  info.data().role == "admin"
                ) {
                  // 이미지가 없을 때
                  if (doc.data().img == null) {
                    template.innerHTML = `<tr>
                <td class="px-2 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img
                        class="h-10 w-10 rounded-full"
                        src="${doc.data().imgURL}"
                        onerror="this.src='${noPhoto}';"
                        alt=""
                      />
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-gray-900">
                        ${doc.data().name}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap" id="${
                  doc.id
                }" onclick="mainclick(this.id)" style="cursor: pointer">
                  <div class="text-sm text-gray-900">${doc.data().title}</div>
                  <div class="text-sm text-gray-500">no image</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                   ${doc
                     .data()
                     .date.toDate()
                     .getFullYear()
                     .toString()
                     .slice(-2)}/${
                      doc.data().date.toDate().getMonth() + 1
                    }/${doc.data().date.toDate().getDate()} ${doc
                      .data()
                      .date.toDate()
                      .getHours()}:${doc
                      .data()
                      .date.toDate()
                      .getMinutes()}:${doc.data().date.toDate().getSeconds()}
                </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  ${doc.data().role}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a onclick="editClick(this.id)" class="text-indigo-600 hover:text-indigo-900" id="${
                    doc.id
                  }" style="cursor:pointer;">
                    Edit
                  </a>
                </td>
              </tr>`;
                    rows.append(template);
                  } else {
                    //이미지가 있을때
                    template.innerHTML = `<tr>
                <td class="px-2 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img
                        class="h-10 w-10 rounded-full"
                        src="${doc.data().imgURL}"
                        onerror="this.src='${noPhoto}';"
                        alt=""
                      />
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-gray-900">
                        ${doc.data().name}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap" id="${
                  doc.id
                }" onclick="mainclick(this.id)" style="cursor: pointer">
                  <div class="text-sm text-gray-900">${doc.data().title}</div>
                  <div class="text-sm text-gray-500">there's img</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                   ${doc
                     .data()
                     .date.toDate()
                     .getFullYear()
                     .toString()
                     .slice(-2)}/${
                      doc.data().date.toDate().getMonth() + 1
                    }/${doc.data().date.toDate().getDate()} ${doc
                      .data()
                      .date.toDate()
                      .getHours()}:${doc
                      .data()
                      .date.toDate()
                      .getMinutes()}:${doc.data().date.toDate().getSeconds()}
                </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  ${doc.data().role}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a onclick="editClick(this.id)" class="text-indigo-600 hover:text-indigo-900" id="${
                    doc.id
                  }" style="cursor:pointer;">
                    Edit
                  </a>
                </td>
              </tr>`;
                    rows.append(template);
                  }
                } else {
                  //이미지가 없을 때
                  if (doc.data().img == null) {
                    template.innerHTML = `<tr>
                <td class="px-2 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img
                        class="h-10 w-10 rounded-full"
                        src="${doc.data().imgURL}"
                        onerror="this.src='${noPhoto}';"
                        alt=""
                      />
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-gray-900">
                        ${doc.data().name}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap" id="${
                  doc.id
                }" onclick="mainclick(this.id)" style="cursor: pointer">
                  <div class="text-sm text-gray-900">${doc.data().title}</div>
                  <div class="text-sm text-gray-500">no image</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                   ${doc
                     .data()
                     .date.toDate()
                     .getFullYear()
                     .toString()
                     .slice(-2)}/${
                      doc.data().date.toDate().getMonth() + 1
                    }/${doc.data().date.toDate().getDate()} ${doc
                      .data()
                      .date.toDate()
                      .getHours()}:${doc
                      .data()
                      .date.toDate()
                      .getMinutes()}:${doc.data().date.toDate().getSeconds()}
                </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  ${doc.data().role}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a onclick="editClick(this.id)" class="hidden text-indigo-600 hover:text-indigo-900" id="${
                    doc.id
                  }" style="cursor:pointer;">
                    Edit
                  </a>
                </td>
              </tr>`;
                    rows.append(template);
                  } else {
                    //이미지가 있을 때
                    template.innerHTML = `<tr>
                <td class="px-2 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img
                        class="h-10 w-10 rounded-full"
                        src="${doc.data().imgURL}"
                        onerror="this.src='${noPhoto}';"
                        alt=""
                      />
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-gray-900">
                        ${doc.data().name}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap" id="${
                  doc.id
                }" onclick="mainclick(this.id)" style="cursor: pointer">
                  <div class="text-sm text-gray-900">${doc.data().title}</div>
                  <div class="text-sm text-gray-500">there's img</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                   ${doc
                     .data()
                     .date.toDate()
                     .getFullYear()
                     .toString()
                     .slice(-2)}/${
                      doc.data().date.toDate().getMonth() + 1
                    }/${doc.data().date.toDate().getDate()} ${doc
                      .data()
                      .date.toDate()
                      .getHours()}:${doc
                      .data()
                      .date.toDate()
                      .getMinutes()}:${doc.data().date.toDate().getSeconds()}
                </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  ${doc.data().role}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a onclick="editClick(this.id)" class="hidden text-indigo-600 hover:text-indigo-900" id="${
                    doc.id
                  }" style="cursor:pointer;">
                    Edit
                  </a>
                </td>
              </tr>`;
                    rows.append(template);
                  }
                }
              });
          } else {
            if (doc.data().img == null) {
              template.innerHTML = `<tr>
                <td class="px-2 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img
                        class="h-10 w-10 rounded-full"
                        src="${doc.data().imgURL}"
                        onerror="this.src='${noPhoto}';"
                        alt=""
                      />
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-gray-900">
                        ${doc.data().name}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap" id="${
                  doc.id
                }" onclick="mainclick(this.id)" style="cursor: pointer">
                  <div class="text-sm text-gray-900">${doc.data().title}</div>
                  <div class="text-sm text-gray-500">no image</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                   ${doc
                     .data()
                     .date.toDate()
                     .getFullYear()
                     .toString()
                     .slice(-2)}/${
                doc.data().date.toDate().getMonth() + 1
              }/${doc.data().date.toDate().getDate()} ${doc
                .data()
                .date.toDate()
                .getHours()}:${doc.data().date.toDate().getMinutes()}:${doc
                .data()
                .date.toDate()
                .getSeconds()}
                </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  ${doc.data().role}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a onclick="editClick(this.id)" class="hidden text-indigo-600 hover:text-indigo-900" id="${
                    doc.id
                  }" style="cursor:pointer;">
                    Edit
                  </a>
                </td>
              </tr>`;
              rows.append(template);
            } else {
              //이미지가 있을 때
              template.innerHTML = `<tr>
                <td class="px-2 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img
                        class="h-10 w-10 rounded-full"
                        src="${doc.data().imgURL}"
                        onerror="this.src='${noPhoto}';"
                        alt=""
                      />
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-gray-900">
                        ${doc.data().name}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap" id="${
                  doc.id
                }" onclick="mainclick(this.id)" style="cursor: pointer">
                  <div class="text-sm text-gray-900">${doc.data().title}</div>
                  <div class="text-sm text-gray-500">there's img</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                   ${doc
                     .data()
                     .date.toDate()
                     .getFullYear()
                     .toString()
                     .slice(-2)}/${
                doc.data().date.toDate().getMonth() + 1
              }/${doc.data().date.toDate().getDate()} ${doc
                .data()
                .date.toDate()
                .getHours()}:${doc.data().date.toDate().getMinutes()}:${doc
                .data()
                .date.toDate()
                .getSeconds()}
                </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  ${doc.data().role}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a onclick="editClick(this.id)" class="hidden text-indigo-600 hover:text-indigo-900" id="${
                    doc.id
                  }" style="cursor:pointer;">
                    Edit
                  </a>
                </td>
              </tr>`;
              rows.append(template);
            }
          }
        });
      }
      //all the lists
      function morePage() {
        rows.innerHTML = "";
        db.collection("Board")
          .orderBy("date", "desc")
          .get()
          .then((allItems) => {
            allItems.forEach((allDoc) => {
              writingRows(allDoc);
              document.getElementById("total-num").innerText = totalLength;
            });
          });
      }
      // next page
      function nextPage() {
        if (pages <= currentPage) {
          alert("마지막 페이지입니다.");
        } else {
          currentPage += 1;
          let next = db
            .collection("Board")
            .orderBy("date", "desc")
            .startAfter(lastVisible)
            .limit(10);

          next.get().then((nextItems) => {
            lastVisible = nextItems.docs[nextItems.docs.length - 1];
            firstVisible =
              nextItems.docs[nextItems.docs.length - nextItems.docs.length];
            rows.innerHTML = "";
            document.getElementById("page-num").innerText = currentPage;
            nextItems.forEach((nextDoc) => {
              writingRows(nextDoc);
            });
          });
        }
      }
      //previous page
      function previousPage() {
        if (currentPage == 1) {
          alert("첫 페이지입니다.");
        } else {
          currentPage -= 1;

          let previous = db
            .collection("Board")
            .orderBy("date", "desc")
            .endBefore(firstVisible)
            .limitToLast(10);

          previous.get().then((previousItems) => {
            lastVisible = previousItems.docs[previousItems.docs.length - 1];
            firstVisible =
              previousItems.docs[
                previousItems.docs.length - previousItems.docs.length
              ];
            rows.innerHTML = "";
            document.getElementById("page-num").innerText = currentPage;
            previousItems.forEach((nextDoc) => {
              writingRows(nextDoc);
            });
          });
        }
      }
      // off the toast
      function toastOff() {
        document.getElementById("toast-default").className = "hidden";
      }
    </script>
    <script>
      // 편집기능
      const editModal = document.getElementById("edit-modal");
      const editTitle = document.getElementById("title");
      const editContents = document.getElementById("content");
      const deleteBtn = document.getElementById("delete-btn");
      const editBtn = document.getElementById("edit-btn");
      const imgCheck = document.getElementById("image");

      function editClick(a) {
        deleteBtn.id = a;
        editBtn.id = a;
        let docRef = firebase.firestore().collection("Board").doc(`${a}`);
        editModal.className = "visible container flex justify-center mx-auto";
        docRef
          .get()
          .then((doc) => {
            editTitle.value = doc.data().title;
            editContents.value = doc.data().contents;
          })
          .catch((error) => {
            alert("Error getting document:", error);
          });
      }
      function xClick() {
        editModal.className = "hidden container flex justify-center mx-auto";
        editTitle.value = "";
        editContents.value = "";
      }
      function deleteClick(a) {
        let docRef = firebase.firestore().collection("Board").doc(`${a}`);
        let storage = firebase.storage();
        // delete firestore
        docRef
          .get()
          .then((doc) => {
            if (doc.data().img == undefined) {
              docRef
                .delete()
                .then(() => {
                  alert("Document successfully deleted!");
                  window.location.href = "./index.html";
                })
                .catch((error) => {
                  alert("Error removing document: ", error);
                });
            } else {
              let httpsReference = storage.refFromURL(`${doc.data().img}`);
              let desertRef = storage
                .ref()
                .child(`${httpsReference._delegate._location.path_}`);
              desertRef
                .delete()
                .then(() => {
                  alert("이미지 지워짐");
                  docRef
                    .delete()
                    .then(() => {
                      alert("Document successfully deleted!");
                      window.location.href = "./index.html";
                    })
                    .catch((error) => {
                      alert("Error removing document: ", error);
                    });
                })
                .catch((error) => {
                  alert("이미지 지우다 오류!");
                });
            }
          })
          .catch((error) => {
            alert("Error getting document:", error);
          });
      }
      function rewrite(a) {
        let rewriteDoc = firebase.firestore().collection("Board").doc(`${a}`);
        let storage = firebase.storage();
        if (imgCheck.value == "") {
          rewriteDoc
            .update({
              title: document.getElementById("title").value,
              contents: document.getElementById("content").value,
            })
            .then(() => {
              alert("Document successfully written!");
              window.location.href = "./index.html";
            })
            .catch((error) => {
              alert("Error writing document: " + error);
            });
        } else {
          //일단 이미지 지우고
          rewriteDoc.get().then((doc) => {
            let httpsReference = storage.refFromURL(`${doc.data().img}`);
            let desertRef = storage
              .ref()
              .child(`${httpsReference._delegate._location.path_}`);
            desertRef
              .delete()
              .then(() => {
                alert("the og img successfully deleted");
              })
              .catch((error) => {
                alert("이미지 바꾸다가 오류!");
              });
          });
          //다시 이미지 넣자
          let file = document.getElementById("image").files[0];
          let storageRef = storage.ref();
          let imagePath = storageRef.child("image/" + file.name);
          let uploadImg = imagePath.put(file);

          uploadImg.on(
            "state_changed",
            // 변화시 동작하는 함수
            null,
            //에러시 동작하는 함수
            (error) => {
              console.error("실패사유는", error);
            },
            // 성공시 동작하는 함수
            () => {
              uploadImg.snapshot.ref.getDownloadURL().then((url) => {
                let objects = {
                  title: document.getElementById("title").value,
                  contents: document.getElementById("content").value,
                  img: url,
                };
                rewriteDoc
                  .update(objects)
                  .then(() => {
                    alert("수정 성공");
                    window.location.href = "./index.html";
                  })
                  .catch((err) => {
                    alert("수정 실패, 수정 버튼을 다시 눌러주세요.");
                  });
              });
            }
          );
        }
      }
    </script>
    <script>
      //main modal js
      const mainModal = document.getElementById("main-modal");
      const mainTitle = document.getElementById("main-title");
      const mainContent = document.getElementById("main-content");
      const mainImg = document.getElementById("main-img");
      const mainModalAbsoulte = document.getElementById("main-modal-absoulte");

      function mainclick(a) {
        document.getElementById("comment-submit").ariaLabel = `${a}`;
        //comments
        firebase
          .firestore()
          .collection("Board")
          .doc(`${a}`)
          .collection("comments")
          .get()
          .then((items) => {
            items.forEach((mindoc) => {
              firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                  db.collection("Users")
                    .doc(`${user.email}`)
                    .get()
                    .then((info) => {
                      if (
                        mindoc.data().userId == user.email ||
                        info.data().role == "admin"
                      ) {
                        let mainComments =
                          document.getElementById("main-comments");
                        let commentsTemplate = document.createElement("div");
                        document.getElementById("no-comments").className =
                          "flex hidden justify-center border-t border-b py-1";
                        commentsTemplate.innerHTML = `
                        <div class="flex w-full items-center border-t border-b py-1" id='${
                          mindoc.id
                        }'>
                          <div class="-space-x-2 mr-2">
                            <img
                              class="inline-block h-6 w-6 rounded-full ring-2 ring-white"
                              src="${mindoc.data().photo}"
                              alt=""
                            />
                          </div>
                          <span class="w-2/12 mr-2">${mindoc.data().name}</span>
                          <span class="w-6/12">${mindoc.data().contents}</span>
                          <span class="w-4/12 text-right mr-2">${mindoc
                            .data()
                            .time.toDate()
                            .getFullYear()
                            .toString()
                            .slice(-2)}/${
                          mindoc.data().time.toDate().getMonth() + 1
                        }/${mindoc.data().time.toDate().getDate()} ${mindoc
                          .data()
                          .time.toDate()
                          .getHours()}:${mindoc
                          .data()
                          .time.toDate()
                          .getMinutes()}:${mindoc
                          .data()
                          .time.toDate()
                          .getSeconds()}
                          </span>
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-5 h-5"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            style="cursor: pointer"
                            onclick="commentDelete('${mindoc.id}', '${a}')"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
                            />
                          </svg>
                        </div>`;
                        mainComments.append(commentsTemplate);
                      } else {
                        let mainComments =
                          document.getElementById("main-comments");
                        let commentsTemplate = document.createElement("div");
                        document.getElementById("no-comments").className =
                          "flex hidden justify-center border-t border-b py-1";
                        commentsTemplate.innerHTML = `
                        <div class="flex w-full items-center border-t border-b py-1" id='${
                          mindoc.id
                        }'>
                          <div class="-space-x-2 mr-2">
                            <img
                              class="inline-block h-6 w-6 rounded-full ring-2 ring-white"
                              src="${mindoc.data().photo}"
                              alt=""
                            />
                          </div>
                          <span class="w-2/12 mr-2">${mindoc.data().name}</span>
                          <span class="w-6/12">${mindoc.data().contents}</span>
                          <span class="w-4/12 text-right mr-2">${mindoc
                            .data()
                            .time.toDate()
                            .getFullYear()
                            .toString()
                            .slice(-2)}/${
                          mindoc.data().time.toDate().getMonth() + 1
                        }/${mindoc.data().time.toDate().getDate()} ${mindoc
                          .data()
                          .time.toDate()
                          .getHours()}:${mindoc
                          .data()
                          .time.toDate()
                          .getMinutes()}:${mindoc
                          .data()
                          .time.toDate()
                          .getSeconds()}
                          </span>
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-5 h-5 hidden"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            style="cursor: pointer"
                            onclick="commentDelete('${mindoc.id}', '${a}')"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
                            />
                          </svg>
                        </div>`;
                        mainComments.append(commentsTemplate);
                      }
                    });
                } else {
                  let mainComments = document.getElementById("main-comments");
                  let commentsTemplate = document.createElement("div");
                  document.getElementById("no-comments").className =
                    "flex hidden justify-center border-t border-b py-1";
                  commentsTemplate.innerHTML = `
                        <div class="flex w-full items-center border-t border-b py-1" id='${
                          mindoc.id
                        }'>
                          <div class="-space-x-2 mr-2">
                            <img
                              class="inline-block h-6 w-6 rounded-full ring-2 ring-white"
                              src="${mindoc.data().photo}"
                              alt=""
                            />
                          </div>
                          <span class="w-2/12 mr-2">${mindoc.data().name}</span>
                          <span class="w-6/12">${mindoc.data().contents}</span>
                          <span class="w-4/12 text-right mr-2">${mindoc
                            .data()
                            .time.toDate()
                            .getFullYear()
                            .toString()
                            .slice(-2)}/${
                    mindoc.data().time.toDate().getMonth() + 1
                  }/${mindoc.data().time.toDate().getDate()} ${mindoc
                    .data()
                    .time.toDate()
                    .getHours()}:${mindoc
                    .data()
                    .time.toDate()
                    .getMinutes()}:${mindoc.data().time.toDate().getSeconds()}
                          </span>
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-5 h-5 hidden"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            style="cursor: pointer"
                            onclick="commentDelete('${mindoc.id}', '${a}')"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
                            />
                          </svg>
                        </div>`;
                  mainComments.append(commentsTemplate);
                }
              });
            });
          });

        firebase
          .firestore()
          .collection("Board")
          .doc(`${a}`)
          .get()
          .then((doc) => {
            if (doc.data().img == undefined) {
              mainModal.className = "bg-gray-50 visible container";
              mainModalAbsoulte.className =
                "fixed items-center inset-0 flex justify-center bg-gray-700 bg-opacity-50";
              mainTitle.innerText = `제목 : ${doc.data().title}`;
              mainContent.innerText = `내용 : 
              ${doc.data().contents}`;
            } else {
              mainModal.className = "bg-gray-50 visible container";
              mainModalAbsoulte.className =
                "fixed items-center inset-0 flex justify-center bg-gray-700 bg-opacity-50";
              mainTitle.innerText = `제목 : ${doc.data().title}`;
              mainContent.innerText = `내용 : 
              ${doc.data().contents}`;
              mainImg.setAttribute("src", `${doc.data().img}`);
            }
          })
          .catch((error) => {
            mainModal.className = "bg-gray-50 visible container";
            mainTitle.innerText = `에러 발생 : ${error}`;
          });
      }
      function mainXClick(a) {
        mainModal.className = "bg-gray-50 hidden container";
        mainTitle.innerText = ``;
        mainContent.innerText = ``;
        mainModalAbsoulte.className =
          "absolute items-center inset-0 flex justify-center bg-gray-700 bg-opacity-50";
        mainImg.removeAttribute("src");
        document.getElementById(
          "main-comments"
        ).innerHTML = `<span class="text-indigo-600 font-semibold text-lg"
                  >Comments</span
                >
                <div
                  class="flex justify-center border-t border-b py-1"
                  id="no-comments"
                >
                  <div class="-space-x-2">댓글 없음</div>
                </div>
              </div>`;
        document.getElementById("comment-content").value = "";
      }
    </script>
    <script>
      //coments js
      const commentContent = document.getElementById("comment-content");
      // comment submit
      function submitClick(a) {
        firebase.auth().onAuthStateChanged((user) => {
          if (user) {
            db.collection("Users")
              .doc(`${user.email}`)
              .get()
              .then((nowUser) => {
                if (nowUser.data().photoURL == null) {
                  let objects = {
                    userId: user.email,
                    name: `${nowUser.data().nickname}`,
                    photo: noPhoto,
                    contents: commentContent.value,
                    time: new Date(),
                  };
                  db.collection("Board")
                    .doc(`${a}`)
                    .collection("comments")
                    .add(objects)
                    .then((doc) => {
                      alert("댓글 업로드 성공");
                      let mainComments =
                        document.getElementById("main-comments");
                      let commentsTemplate = document.createElement("div");
                      document.getElementById("no-comments").className =
                        "flex hidden justify-center border-t border-b py-1";
                      commentsTemplate.innerHTML = `<div class="flex w-full items-center border-t border-b py-1" 
                    id="${doc.id}">
                      <div class="-space-x-2 mr-2">
                        <img
                          class="inline-block h-6 w-6 rounded-full ring-2 ring-white"
                          src="${objects.photo}"
                          alt=""
                          onerror="this.src='${noPhoto}';"
                        />
                      </div>
                      <span class="w-2/12 mr-2">${objects.name}</span>
                      <span class="w-6/12">${objects.contents}</span>
                      <span class="w-4/12 text-right mr-2">
                        ${objects.time.getFullYear().toString().slice(-2)}/${
                        objects.time.getMonth() + 1
                      }/${objects.time.getDate()} ${objects.time.getHours()}:${objects.time.getMinutes()}:${objects.time.getSeconds()}
                      </span>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="w-5 h-5"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        style="cursor: pointer"
                        onclick="commentDelete('${doc.id}', '${a}')"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
                        />
                      </svg>
                    </div>`;
                      mainComments.append(commentsTemplate);
                    })
                    .catch((err) => {
                      alert("댓글 업로드 실패, 올리기 버튼을 다시 눌러주세요.");
                    });
                  commentContent.value = "";
                } else {
                  let objects = {
                    userId: user.email,
                    name: `${nowUser.data().nickname}`,
                    photo: `${nowUser.data().photoURL}`,
                    contents: commentContent.value,
                    time: new Date(),
                  };
                  db.collection("Board")
                    .doc(`${a}`)
                    .collection("comments")
                    .add(objects)
                    .then((doc) => {
                      alert("댓글 업로드 성공");
                      let mainComments =
                        document.getElementById("main-comments");
                      let commentsTemplate = document.createElement("div");
                      document.getElementById("no-comments").className =
                        "flex hidden justify-center border-t border-b py-1";
                      commentsTemplate.innerHTML = `<div class="flex w-full items-center border-t border-b py-1" 
                    id="${doc.id}">
                      <div class="-space-x-2 mr-2">
                        <img
                          class="inline-block h-6 w-6 rounded-full ring-2 ring-white"
                          src="${objects.photo}"
                          alt=""
                          onerror="this.src="${noPhoto}";"
                        />
                      </div>
                      <span class="w-2/12 mr-2">${objects.name}</span>
                      <span class="w-6/12">${objects.contents}</span>
                      <span class="w-4/12 text-right mr-2">
                        ${objects.time.getFullYear().toString().slice(-2)}/${
                        objects.time.getMonth() + 1
                      }/${objects.time.getDate()} ${objects.time.getHours()}:${objects.time.getMinutes()}:${objects.time.getSeconds()}
                      </span>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="w-5 h-5"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        style="cursor: pointer"
                        onclick="commentDelete('${doc.id}', '${a}')"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
                        />
                      </svg>
                    </div>`;
                      mainComments.append(commentsTemplate);
                    })
                    .catch((err) => {
                      alert("댓글 업로드 실패, 올리기 버튼을 다시 눌러주세요.");
                    });
                  commentContent.value = "";
                }
              });
          }
        });
      }
      //comment delete
      function commentDelete(a, b) {
        firebase
          .firestore()
          .collection("Board")
          .doc(`${b}`)
          .collection("comments")
          .doc(`${a}`)
          .delete()
          .then(() => {
            alert("댓글 삭제됨");
            document.getElementById(`${a}`).className =
              "flex w-full items-center justify-center border-t border-b py-1";
            document.getElementById(
              `${a}`
            ).innerHTML = `<span>댓글이 삭제되었습니다.</span>`;
          });
      }
    </script>
    <script>
      //로그인 되어있는지 확인 후 프로필 설정, 버튼 재 설정
      firebase.auth().onAuthStateChanged((user) => {
        if (user) {
          document.getElementById("toast-contents").innerText =
            "상단의 프로필을 클릭해 본인 만의 프로필을 꾸며보세요!";
          document.getElementById("log-in").className = "hidden";
          document.getElementById("log-out").className =
            "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500";
          document.getElementById("sign-up").className = "hidden";
          db.collection("Users")
            .doc(`${user.email}`)
            .get()
            .then((info) => {
              document.getElementById("profile-role").innerText =
                info.data().role;
              document.getElementById("profile-nick").innerText =
                info.data().nickname;
              document.getElementById("comments-nick").innerText = `${
                info.data().nickname
              }`;
              if (info.data().photoURL !== null) {
                document
                  .getElementById("profile-img")
                  .setAttribute("src", `${info.data().photoURL}`);
                document
                  .getElementById("comments-img")
                  .setAttribute("src", `${info.data().photoURL}`);
              }
            });
          // 댓글 기능 로그인시에만 가능하도록
        } else {
          document.getElementById("write").className = "hidden";
          document.getElementById("log-out").className = "hidden";
          document.getElementById("nav-bar-profile").remove();
          document.getElementById("with-login1").className = "text-center";
          document.getElementById("with-login1").innerHTML =
            "<div><h1 class='font-semibold mb-2'>댓글은 로그인후 작성 가능합니다.</h1></div>";
          document.getElementById("with-login2").className = "hidden";
          document.getElementById("with-login3").className = "hidden";
        }
      });
      // 로그아웃
      function logOut() {
        firebase
          .auth()
          .signOut()
          .then(() => {
            alert("로그아웃되었습니다.");
            window.location.reload();
          })
          .catch((error) => {
            alert(error.message);
          });
      }
      // 프로필 클릭
      function profileClick() {
        window.location.href = "./profile.html";
      }
    </script>
  </body>
</html>
